<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height" />
  <link rel="import" href="elements.html">
  <style>
    .fix {
      position: fixed; 
      top: 0; 
      width: 100%;
    }
  </style>
  <script type="text/javascript" src="js/index.js"></script>
</head>
<body>
  <div id="mainDiv"></div>
  <paper-drawer-panel id="menu">
    <paper-header-panel drawer style="z-index:5;">
      Sidebar
    </paper-header-panel>
    <paper-header-panel main>
      <paper-toolbar class="fix">
        <iron-icon icon="menu" onclick="toggle()"></iron-icon>
      </paper-toolbar>
      <div style="height:100%;">
        <div style="border-bottom:3px solid black; height:50%;">
          <div style="top:55px; position:absolute; overflow:hidden" >
            <!-- Insert map here -->
            
          </div>
        </div>
        <div id="recboxDiv" style="top:50%; height:50%; width:100%; overflow-y:auto; overflow-x:hidden;">
        <rec-box dist="30" name="something"></rec-box>
        </div>
      </div>
      <paper-fab icon="add" id="capturePhotoButton"></paper-fab>
    </paper-header-panel>
  </paper-drawer-panel>

  <script>
    function toggle() {
      document.getElementById('menu').togglePanel();
    }
    $(window).load(function() {
        $("#mainDiv").load("loadingTwo.html");
    });
    $(document).ready(function() {
      $(window).load(function() {
        $.ajax({
          url: "http://845edac5.ngrok.io/users/",
          method: "GET",
          data: {'username': localStorage.getItem('username'),
                 'lat': 42.3598,
                 'lon': 71.0921,
                 'quant': 10,
          },
          success: function(result) {
            result = JSON.parse(result);
            var div = $("#recboxDiv");
            for(var x = 0; x < result.myItems.length; x++) {
              $.ajax({
                url: "http://845edac5.ngrok.io/data/",
                method: "GET",
                data: {'id': result.myItems[x]},
                success: function(result) {
                  result = JSON.parse(result);
                  div.append("<rec-box dist=" + Math.round(result.dist/1000) + "></rec-box>");
                },
              });
            }
            $("#mainDiv").remove();
          },
        });
      })

    })
  </script>
</body>
</head>